Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=1024, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=256, data='ETTh1', data_path='ETTh1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1', distil=True, do_predict=False, dropout=0.2, e_layers=1, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.05, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=0, learning_rate=0.0001, loss='mse', loss_flag=2, lradj='type3', mixer_kernel_size=8, model='PatchMixer', model_id='336_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=10, pct_start=0.3, pred_len=96, random_seed=2021, revin=1, root_path='./dataset/ETT-small/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : loss_flag2_lr0.0001_dm256_336_96_PatchMixer_ETTh1_ftM_sl336_pl96_p16s8_random2021_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
Epoch: 1 cost time: 1.886112928390503
vali loss: 1.3665841817855835
vali loss: 0.7236018776893616
Epoch: 1, Steps: 8 | Train Loss: 0.6201902 Vali Loss: 1.1038568 Test Loss: 0.6503278
Validation loss decreased (inf --> 1.103857).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 1.822563648223877
vali loss: 1.0120224952697754
vali loss: 0.6011756658554077
Epoch: 2, Steps: 8 | Train Loss: 0.5230671 Vali Loss: 0.8567439 Test Loss: 0.5664850
Validation loss decreased (1.103857 --> 0.856744).  Saving model ...
Updating learning rate to 0.0001
Epoch: 3 cost time: 1.890885353088379
vali loss: 0.8379395008087158
vali loss: 0.4705868661403656
Epoch: 3, Steps: 8 | Train Loss: 0.5107324 Vali Loss: 0.7344526 Test Loss: 0.4684694
Validation loss decreased (0.856744 --> 0.734453).  Saving model ...
Updating learning rate to 0.0001
Epoch: 4 cost time: 1.8985214233398438
vali loss: 0.7642129063606262
vali loss: 0.42823487520217896
Epoch: 4, Steps: 8 | Train Loss: 0.4385080 Vali Loss: 0.6892574 Test Loss: 0.4378707
Validation loss decreased (0.734453 --> 0.689257).  Saving model ...
Updating learning rate to 9e-05
Epoch: 5 cost time: 1.8136036396026611
vali loss: 0.7378249764442444
vali loss: 0.38690105080604553
Epoch: 5, Steps: 8 | Train Loss: 0.4228970 Vali Loss: 0.6681989 Test Loss: 0.4010078
Validation loss decreased (0.689257 --> 0.668199).  Saving model ...
Updating learning rate to 8.1e-05
Epoch: 6 cost time: 1.8647634983062744
vali loss: 0.7143065333366394
vali loss: 0.3782958388328552
Epoch: 6, Steps: 8 | Train Loss: 0.4053443 Vali Loss: 0.6466553 Test Loss: 0.3923526
Validation loss decreased (0.668199 --> 0.646655).  Saving model ...
Updating learning rate to 7.290000000000001e-05
Epoch: 7 cost time: 1.9208533763885498
vali loss: 0.7108199596405029
vali loss: 0.3800947368144989
Epoch: 7, Steps: 8 | Train Loss: 0.3983813 Vali Loss: 0.6396666 Test Loss: 0.3936067
Validation loss decreased (0.646655 --> 0.639667).  Saving model ...
Updating learning rate to 6.561e-05
Epoch: 8 cost time: 1.905968427658081
vali loss: 0.6998080611228943
vali loss: 0.3689418435096741
Epoch: 8, Steps: 8 | Train Loss: 0.3940351 Vali Loss: 0.6298470 Test Loss: 0.3830099
Validation loss decreased (0.639667 --> 0.629847).  Saving model ...
Updating learning rate to 5.904900000000001e-05
Epoch: 9 cost time: 2.166200637817383
vali loss: 0.6846798658370972
vali loss: 0.36170610785484314
Epoch: 9, Steps: 8 | Train Loss: 0.3893339 Vali Loss: 0.6199065 Test Loss: 0.3762535
Validation loss decreased (0.629847 --> 0.619906).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
Epoch: 10 cost time: 1.8651354312896729
vali loss: 0.6855428814888
vali loss: 0.3590523600578308
Epoch: 10, Steps: 8 | Train Loss: 0.3860135 Vali Loss: 0.6218794 Test Loss: 0.3736640
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
Epoch: 11 cost time: 1.8621950149536133
vali loss: 0.6692846417427063
vali loss: 0.3579774796962738
Epoch: 11, Steps: 8 | Train Loss: 0.3846092 Vali Loss: 0.6100475 Test Loss: 0.3722236
Validation loss decreased (0.619906 --> 0.610048).  Saving model ...
Updating learning rate to 4.304672100000001e-05
Epoch: 12 cost time: 1.8329370021820068
vali loss: 0.6800276041030884
vali loss: 0.35749849677085876
Epoch: 12, Steps: 8 | Train Loss: 0.3831777 Vali Loss: 0.6173556 Test Loss: 0.3714478
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
Epoch: 13 cost time: 2.2701284885406494
vali loss: 0.6649944186210632
vali loss: 0.3568395972251892
Epoch: 13, Steps: 8 | Train Loss: 0.3820659 Vali Loss: 0.6064703 Test Loss: 0.3707860
Validation loss decreased (0.610048 --> 0.606470).  Saving model ...
Updating learning rate to 3.486784401000001e-05
Epoch: 14 cost time: 2.3189239501953125
vali loss: 0.6790059804916382
vali loss: 0.3558568060398102
Epoch: 14, Steps: 8 | Train Loss: 0.3810147 Vali Loss: 0.6149278 Test Loss: 0.3699165
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
Epoch: 15 cost time: 2.3892900943756104
vali loss: 0.6604376435279846
vali loss: 0.3546191155910492
Epoch: 15, Steps: 8 | Train Loss: 0.3802275 Vali Loss: 0.6018260 Test Loss: 0.3688439
Validation loss decreased (0.606470 --> 0.601826).  Saving model ...
Updating learning rate to 2.824295364810001e-05
Epoch: 16 cost time: 2.36407732963562
vali loss: 0.6634567975997925
vali loss: 0.3537125289440155
Epoch: 16, Steps: 8 | Train Loss: 0.3795952 Vali Loss: 0.6046655 Test Loss: 0.3680215
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
Epoch: 17 cost time: 2.255671501159668
vali loss: 0.6763849258422852
vali loss: 0.35319089889526367
Epoch: 17, Steps: 8 | Train Loss: 0.3792771 Vali Loss: 0.6133567 Test Loss: 0.3675002
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
Epoch: 18 cost time: 2.3466508388519287
vali loss: 0.6705405712127686
vali loss: 0.3529702126979828
Epoch: 18, Steps: 8 | Train Loss: 0.3789586 Vali Loss: 0.6097876 Test Loss: 0.3672264
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0589113209464907e-05
Epoch: 19 cost time: 2.351179599761963
vali loss: 0.6754046678543091
vali loss: 0.3527742028236389
Epoch: 19, Steps: 8 | Train Loss: 0.3784401 Vali Loss: 0.6128968 Test Loss: 0.3669908
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.8530201888518416e-05
Epoch: 20 cost time: 2.31203556060791
vali loss: 0.6632466316223145
vali loss: 0.35265785455703735
Epoch: 20, Steps: 8 | Train Loss: 0.3781650 Vali Loss: 0.6043996 Test Loss: 0.3668236
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.6677181699666577e-05
Epoch: 21 cost time: 2.3432343006134033
vali loss: 0.6627367734909058
vali loss: 0.3525736331939697
Epoch: 21, Steps: 8 | Train Loss: 0.3777583 Vali Loss: 0.6037526 Test Loss: 0.3667089
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.5009463529699919e-05
Epoch: 22 cost time: 2.3290932178497314
vali loss: 0.6651496887207031
vali loss: 0.352446585893631
Epoch: 22, Steps: 8 | Train Loss: 0.3777653 Vali Loss: 0.6049590 Test Loss: 0.3665594
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.3508517176729929e-05
Epoch: 23 cost time: 2.317652702331543
vali loss: 0.6661116480827332
vali loss: 0.35230526328086853
Epoch: 23, Steps: 8 | Train Loss: 0.3773575 Vali Loss: 0.6058195 Test Loss: 0.3664066
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.2157665459056936e-05
Epoch: 24 cost time: 2.3061575889587402
vali loss: 0.6626895070075989
vali loss: 0.35216420888900757
Epoch: 24, Steps: 8 | Train Loss: 0.3771515 Vali Loss: 0.6040677 Test Loss: 0.3662680
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.0941898913151242e-05
Epoch: 25 cost time: 2.3207993507385254
vali loss: 0.6605252623558044
vali loss: 0.3520144820213318
Epoch: 25, Steps: 8 | Train Loss: 0.3768174 Vali Loss: 0.6029556 Test Loss: 0.3661213
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : loss_flag2_lr0.0001_dm256_336_96_PatchMixer_ETTh1_ftM_sl336_pl96_p16s8_random2021_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.3546191155910492, mae:0.3830685317516327, rse:0.5755488276481628
