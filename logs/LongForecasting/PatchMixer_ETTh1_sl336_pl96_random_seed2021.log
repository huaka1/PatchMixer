Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=1024, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=256, data='ETTh1', data_path='ETTh1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1', distil=True, do_predict=False, dropout=0.2, e_layers=1, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.05, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=0, learning_rate=0.0001, loss='mse', loss_flag=2, lradj='type3', mixer_kernel_size=8, model='PatchMixer', model_id='336_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=10, pct_start=0.3, pred_len=96, random_seed=2021, revin=1, root_path='./dataset/ETT-small/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : loss_flag2_lr0.0001_dm256_336_96_PatchMixer_ETTh1_ftM_sl336_pl96_p16s8_random2021_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
Epoch: 1 cost time: 2.157400608062744
Epoch: 1, Steps: 8 | Train Loss: 0.6147759 Vali Loss: 1.0982752 Test Loss: 0.6494030
Validation loss decreased (inf --> 1.098275).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 2.1739912033081055
Epoch: 2, Steps: 8 | Train Loss: 0.5172491 Vali Loss: 0.9706590 Test Loss: 0.6489762
Validation loss decreased (1.098275 --> 0.970659).  Saving model ...
Updating learning rate to 0.0001
Epoch: 3 cost time: 2.1439459323883057
Epoch: 3, Steps: 8 | Train Loss: 0.5083243 Vali Loss: 0.7345792 Test Loss: 0.4769263
Validation loss decreased (0.970659 --> 0.734579).  Saving model ...
Updating learning rate to 0.0001
Epoch: 4 cost time: 2.138517141342163
Epoch: 4, Steps: 8 | Train Loss: 0.4330844 Vali Loss: 0.6934751 Test Loss: 0.4397511
Validation loss decreased (0.734579 --> 0.693475).  Saving model ...
Updating learning rate to 9e-05
Epoch: 5 cost time: 2.189694404602051
Epoch: 5, Steps: 8 | Train Loss: 0.4180679 Vali Loss: 0.6690400 Test Loss: 0.4028839
Validation loss decreased (0.693475 --> 0.669040).  Saving model ...
Updating learning rate to 8.1e-05
Epoch: 6 cost time: 2.291780471801758
Epoch: 6, Steps: 8 | Train Loss: 0.4004379 Vali Loss: 0.6483060 Test Loss: 0.3928934
Validation loss decreased (0.669040 --> 0.648306).  Saving model ...
Updating learning rate to 7.290000000000001e-05
Epoch: 7 cost time: 2.19332218170166
Epoch: 7, Steps: 8 | Train Loss: 0.3932199 Vali Loss: 0.6402189 Test Loss: 0.3941815
Validation loss decreased (0.648306 --> 0.640219).  Saving model ...
Updating learning rate to 6.561e-05
Epoch: 8 cost time: 2.1328861713409424
Epoch: 8, Steps: 8 | Train Loss: 0.3887604 Vali Loss: 0.6319455 Test Loss: 0.3840574
Validation loss decreased (0.640219 --> 0.631945).  Saving model ...
Updating learning rate to 5.904900000000001e-05
Epoch: 9 cost time: 2.211183786392212
Epoch: 9, Steps: 8 | Train Loss: 0.3837495 Vali Loss: 0.6196800 Test Loss: 0.3771344
Validation loss decreased (0.631945 --> 0.619680).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
Epoch: 10 cost time: 2.103356122970581
Epoch: 10, Steps: 8 | Train Loss: 0.3806967 Vali Loss: 0.6185948 Test Loss: 0.3742701
Validation loss decreased (0.619680 --> 0.618595).  Saving model ...
Updating learning rate to 4.782969000000001e-05
Epoch: 11 cost time: 2.190162181854248
Epoch: 11, Steps: 8 | Train Loss: 0.3790835 Vali Loss: 0.6117313 Test Loss: 0.3727043
Validation loss decreased (0.618595 --> 0.611731).  Saving model ...
Updating learning rate to 4.304672100000001e-05
Epoch: 12 cost time: 2.156339406967163
Epoch: 12, Steps: 8 | Train Loss: 0.3775801 Vali Loss: 0.6095675 Test Loss: 0.3718934
Validation loss decreased (0.611731 --> 0.609567).  Saving model ...
Updating learning rate to 3.874204890000001e-05
Epoch: 13 cost time: 2.1663098335266113
Epoch: 13, Steps: 8 | Train Loss: 0.3763939 Vali Loss: 0.6097161 Test Loss: 0.3712415
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
Epoch: 14 cost time: 2.1497597694396973
Epoch: 14, Steps: 8 | Train Loss: 0.3754715 Vali Loss: 0.6151836 Test Loss: 0.3703920
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.138105960900001e-05
Epoch: 15 cost time: 2.1524648666381836
Epoch: 15, Steps: 8 | Train Loss: 0.3747237 Vali Loss: 0.6082220 Test Loss: 0.3692048
Validation loss decreased (0.609567 --> 0.608222).  Saving model ...
Updating learning rate to 2.824295364810001e-05
Epoch: 16 cost time: 2.1126489639282227
Epoch: 16, Steps: 8 | Train Loss: 0.3742288 Vali Loss: 0.6097276 Test Loss: 0.3683692
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
Epoch: 17 cost time: 2.254634380340576
Epoch: 17, Steps: 8 | Train Loss: 0.3738644 Vali Loss: 0.6062170 Test Loss: 0.3678334
Validation loss decreased (0.608222 --> 0.606217).  Saving model ...
Updating learning rate to 2.287679245496101e-05
Epoch: 18 cost time: 2.1207497119903564
Epoch: 18, Steps: 8 | Train Loss: 0.3732921 Vali Loss: 0.6076160 Test Loss: 0.3675570
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
Epoch: 19 cost time: 2.176501750946045
Epoch: 19, Steps: 8 | Train Loss: 0.3727698 Vali Loss: 0.6089489 Test Loss: 0.3673802
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
Epoch: 20 cost time: 2.2586135864257812
Epoch: 20, Steps: 8 | Train Loss: 0.3724425 Vali Loss: 0.6185534 Test Loss: 0.3672400
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6677181699666577e-05
Epoch: 21 cost time: 2.648524284362793
Epoch: 21, Steps: 8 | Train Loss: 0.3721303 Vali Loss: 0.6040341 Test Loss: 0.3671656
Validation loss decreased (0.606217 --> 0.604034).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
Epoch: 22 cost time: 2.666440010070801
Epoch: 22, Steps: 8 | Train Loss: 0.3720883 Vali Loss: 0.6102288 Test Loss: 0.3669266
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
Epoch: 23 cost time: 2.6853606700897217
Epoch: 23, Steps: 8 | Train Loss: 0.3717483 Vali Loss: 0.6065335 Test Loss: 0.3667378
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.2157665459056936e-05
Epoch: 24 cost time: 2.603813886642456
Epoch: 24, Steps: 8 | Train Loss: 0.3717251 Vali Loss: 0.6143504 Test Loss: 0.3665753
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.0941898913151242e-05
Epoch: 25 cost time: 2.59309983253479
Epoch: 25, Steps: 8 | Train Loss: 0.3713656 Vali Loss: 0.6023619 Test Loss: 0.3664440
Validation loss decreased (0.604034 --> 0.602362).  Saving model ...
Updating learning rate to 9.847709021836118e-06
Epoch: 26 cost time: 2.6259422302246094
Epoch: 26, Steps: 8 | Train Loss: 0.3713518 Vali Loss: 0.6018914 Test Loss: 0.3663487
Validation loss decreased (0.602362 --> 0.601891).  Saving model ...
Updating learning rate to 8.862938119652508e-06
Epoch: 27 cost time: 2.6446099281311035
Epoch: 27, Steps: 8 | Train Loss: 0.3711702 Vali Loss: 0.6071937 Test Loss: 0.3662565
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
Epoch: 28 cost time: 2.607558250427246
Epoch: 28, Steps: 8 | Train Loss: 0.3709964 Vali Loss: 0.6073164 Test Loss: 0.3661603
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.178979876918531e-06
Epoch: 29 cost time: 2.607440710067749
Epoch: 29, Steps: 8 | Train Loss: 0.3707894 Vali Loss: 0.6001309 Test Loss: 0.3661531
Validation loss decreased (0.601891 --> 0.600131).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
Epoch: 30 cost time: 2.664909839630127
Epoch: 30, Steps: 8 | Train Loss: 0.3707689 Vali Loss: 0.6014842 Test Loss: 0.3660686
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
Epoch: 31 cost time: 2.648409605026245
Epoch: 31, Steps: 8 | Train Loss: 0.3707048 Vali Loss: 0.6023823 Test Loss: 0.3660194
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
Epoch: 32 cost time: 2.5901787281036377
Epoch: 32, Steps: 8 | Train Loss: 0.3705209 Vali Loss: 0.6114655 Test Loss: 0.3659294
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.710128697246249e-06
Epoch: 33 cost time: 2.5894417762756348
Epoch: 33, Steps: 8 | Train Loss: 0.3704427 Vali Loss: 0.5987924 Test Loss: 0.3658785
Validation loss decreased (0.600131 --> 0.598792).  Saving model ...
Updating learning rate to 4.239115827521624e-06
Epoch: 34 cost time: 2.607515811920166
Epoch: 34, Steps: 8 | Train Loss: 0.3702204 Vali Loss: 0.5980796 Test Loss: 0.3658306
Validation loss decreased (0.598792 --> 0.598080).  Saving model ...
Updating learning rate to 3.815204244769462e-06
Epoch: 35 cost time: 2.657806873321533
Epoch: 35, Steps: 8 | Train Loss: 0.3700437 Vali Loss: 0.6020392 Test Loss: 0.3657939
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
Epoch: 36 cost time: 2.610088348388672
Epoch: 36, Steps: 8 | Train Loss: 0.3703233 Vali Loss: 0.6056976 Test Loss: 0.3657489
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.090315438263264e-06
Epoch: 37 cost time: 2.572678804397583
Epoch: 37, Steps: 8 | Train Loss: 0.3701211 Vali Loss: 0.6041859 Test Loss: 0.3657363
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.7812838944369375e-06
Epoch: 38 cost time: 2.5812911987304688
Epoch: 38, Steps: 8 | Train Loss: 0.3701874 Vali Loss: 0.6068565 Test Loss: 0.3656949
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.503155504993244e-06
Epoch: 39 cost time: 2.5962367057800293
Epoch: 39, Steps: 8 | Train Loss: 0.3701605 Vali Loss: 0.6097721 Test Loss: 0.3656572
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.2528399544939195e-06
Epoch: 40 cost time: 2.5810530185699463
Epoch: 40, Steps: 8 | Train Loss: 0.3700776 Vali Loss: 0.6038641 Test Loss: 0.3656144
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.0275559590445276e-06
Epoch: 41 cost time: 2.602900266647339
Epoch: 41, Steps: 8 | Train Loss: 0.3700815 Vali Loss: 0.6060578 Test Loss: 0.3656139
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.8248003631400751e-06
Epoch: 42 cost time: 2.626145124435425
Epoch: 42, Steps: 8 | Train Loss: 0.3699424 Vali Loss: 0.6078064 Test Loss: 0.3655872
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.6423203268260676e-06
Epoch: 43 cost time: 2.6025171279907227
Epoch: 43, Steps: 8 | Train Loss: 0.3702064 Vali Loss: 0.5993738 Test Loss: 0.3655860
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.4780882941434609e-06
Epoch: 44 cost time: 2.623354196548462
Epoch: 44, Steps: 8 | Train Loss: 0.3700147 Vali Loss: 0.5978423 Test Loss: 0.3655564
Validation loss decreased (0.598080 --> 0.597842).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
Epoch: 45 cost time: 2.582538366317749
Epoch: 45, Steps: 8 | Train Loss: 0.3700647 Vali Loss: 0.6143242 Test Loss: 0.3655539
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.1972515182562034e-06
Epoch: 46 cost time: 2.5856778621673584
Epoch: 46, Steps: 8 | Train Loss: 0.3698312 Vali Loss: 0.6012806 Test Loss: 0.3655509
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.077526366430583e-06
Epoch: 47 cost time: 2.6862144470214844
Epoch: 47, Steps: 8 | Train Loss: 0.3699604 Vali Loss: 0.6018360 Test Loss: 0.3655273
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.697737297875248e-07
Epoch: 48 cost time: 2.5846774578094482
Epoch: 48, Steps: 8 | Train Loss: 0.3696431 Vali Loss: 0.6131953 Test Loss: 0.3655277
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.727963568087723e-07
Epoch: 49 cost time: 2.5785934925079346
Epoch: 49, Steps: 8 | Train Loss: 0.3697066 Vali Loss: 0.6003815 Test Loss: 0.3655187
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.855167211278951e-07
Epoch: 50 cost time: 2.1528608798980713
Epoch: 50, Steps: 8 | Train Loss: 0.3699721 Vali Loss: 0.6053467 Test Loss: 0.3655160
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.069650490151056e-07
Epoch: 51 cost time: 2.621908664703369
Epoch: 51, Steps: 8 | Train Loss: 0.3698949 Vali Loss: 0.6055151 Test Loss: 0.3655171
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.36268544113595e-07
Epoch: 52 cost time: 2.5953876972198486
Epoch: 52, Steps: 8 | Train Loss: 0.3697857 Vali Loss: 0.6096877 Test Loss: 0.3654856
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.726416897022355e-07
Epoch: 53 cost time: 2.610933542251587
Epoch: 53, Steps: 8 | Train Loss: 0.3696650 Vali Loss: 0.6034354 Test Loss: 0.3654733
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.15377520732012e-07
Epoch: 54 cost time: 2.6226749420166016
Epoch: 54, Steps: 8 | Train Loss: 0.3697500 Vali Loss: 0.6014739 Test Loss: 0.3654922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : loss_flag2_lr0.0001_dm256_336_96_PatchMixer_ETTh1_ftM_sl336_pl96_p16s8_random2021_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.3515843451023102, mae:0.3795284628868103, rse:0.5730807781219482
