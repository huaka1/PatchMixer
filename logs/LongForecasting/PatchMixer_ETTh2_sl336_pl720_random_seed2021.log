Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=1024, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=256, data='ETTh2', data_path='ETTh2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1', distil=True, do_predict=False, dropout=0.2, e_layers=1, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.05, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=0, learning_rate=0.0001, loss='mse', loss_flag=2, lradj='type3', mixer_kernel_size=8, model='PatchMixer', model_id='336_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=10, pct_start=0.3, pred_len=720, random_seed=2021, revin=1, root_path='./dataset/ETT-small/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : loss_flag2_lr0.0001_dm256_336_720_PatchMixer_ETTh2_ftM_sl336_pl720_p16s8_random2021_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2161
test 2161
Epoch: 1 cost time: 2.139765501022339
vali loss: 0.7448049187660217
vali loss: 0.42632901668548584
Epoch: 1, Steps: 7 | Train Loss: 0.7737539 Vali Loss: 0.6837090 Test Loss: 0.4402599
Validation loss decreased (inf --> 0.683709).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 2.3276851177215576
vali loss: 0.6216610074043274
vali loss: 0.4146926999092102
Epoch: 2, Steps: 7 | Train Loss: 0.7302097 Vali Loss: 0.5871322 Test Loss: 0.4279608
Validation loss decreased (0.683709 --> 0.587132).  Saving model ...
Updating learning rate to 0.0001
Epoch: 3 cost time: 2.2341017723083496
vali loss: 0.6352060437202454
vali loss: 0.4022602140903473
Epoch: 3, Steps: 7 | Train Loss: 0.7134935 Vali Loss: 0.5992811 Test Loss: 0.4189928
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
Epoch: 4 cost time: 2.1757524013519287
vali loss: 0.6291288137435913
vali loss: 0.39013737440109253
Epoch: 4, Steps: 7 | Train Loss: 0.6881541 Vali Loss: 0.5937762 Test Loss: 0.4084747
EarlyStopping counter: 2 out of 10
Updating learning rate to 9e-05
Epoch: 5 cost time: 2.2325761318206787
vali loss: 0.6215687394142151
vali loss: 0.3904944956302643
Epoch: 5, Steps: 7 | Train Loss: 0.6711202 Vali Loss: 0.5878396 Test Loss: 0.4084033
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.1e-05
Epoch: 6 cost time: 2.1499457359313965
vali loss: 0.6196974515914917
vali loss: 0.39334845542907715
Epoch: 6, Steps: 7 | Train Loss: 0.6639296 Vali Loss: 0.5862073 Test Loss: 0.4104742
Validation loss decreased (0.587132 --> 0.586207).  Saving model ...
Updating learning rate to 7.290000000000001e-05
Epoch: 7 cost time: 2.164372444152832
vali loss: 0.6170937418937683
vali loss: 0.3951869010925293
Epoch: 7, Steps: 7 | Train Loss: 0.6564463 Vali Loss: 0.5837440 Test Loss: 0.4117607
Validation loss decreased (0.586207 --> 0.583744).  Saving model ...
Updating learning rate to 6.561e-05
Epoch: 8 cost time: 2.2194695472717285
vali loss: 0.6202852129936218
vali loss: 0.3941269814968109
Epoch: 8, Steps: 7 | Train Loss: 0.6518476 Vali Loss: 0.5855018 Test Loss: 0.4107339
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
Epoch: 9 cost time: 2.2152211666107178
vali loss: 0.621873676776886
vali loss: 0.39478176832199097
Epoch: 9, Steps: 7 | Train Loss: 0.6454330 Vali Loss: 0.5859352 Test Loss: 0.4110069
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
Epoch: 10 cost time: 2.1563687324523926
vali loss: 0.6191332340240479
vali loss: 0.395062118768692
Epoch: 10, Steps: 7 | Train Loss: 0.6394750 Vali Loss: 0.5835930 Test Loss: 0.4111543
Validation loss decreased (0.583744 --> 0.583593).  Saving model ...
Updating learning rate to 4.782969000000001e-05
Epoch: 11 cost time: 2.2111968994140625
vali loss: 0.6218087077140808
vali loss: 0.39464372396469116
Epoch: 11, Steps: 7 | Train Loss: 0.6342851 Vali Loss: 0.5852300 Test Loss: 0.4106225
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
Epoch: 12 cost time: 2.165334939956665
vali loss: 0.6219831705093384
vali loss: 0.39578306674957275
Epoch: 12, Steps: 7 | Train Loss: 0.6296747 Vali Loss: 0.5851521 Test Loss: 0.4113795
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
Epoch: 13 cost time: 2.209327220916748
vali loss: 0.6226415038108826
vali loss: 0.39706048369407654
Epoch: 13, Steps: 7 | Train Loss: 0.6290959 Vali Loss: 0.5853742 Test Loss: 0.4122371
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.486784401000001e-05
Epoch: 14 cost time: 2.21584153175354
vali loss: 0.6210944056510925
vali loss: 0.3972422778606415
Epoch: 14, Steps: 7 | Train Loss: 0.6225570 Vali Loss: 0.5844060 Test Loss: 0.4123614
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.138105960900001e-05
Epoch: 15 cost time: 2.1800332069396973
vali loss: 0.6185123324394226
vali loss: 0.39695531129837036
Epoch: 15, Steps: 7 | Train Loss: 0.6252212 Vali Loss: 0.5823645 Test Loss: 0.4121536
Validation loss decreased (0.583593 --> 0.582364).  Saving model ...
Updating learning rate to 2.824295364810001e-05
Epoch: 16 cost time: 2.200831651687622
vali loss: 0.6234657168388367
vali loss: 0.3969751000404358
Epoch: 16, Steps: 7 | Train Loss: 0.6183876 Vali Loss: 0.5857855 Test Loss: 0.4120284
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
Epoch: 17 cost time: 2.1788458824157715
vali loss: 0.6280839443206787
vali loss: 0.3974306583404541
Epoch: 17, Steps: 7 | Train Loss: 0.6198422 Vali Loss: 0.5888431 Test Loss: 0.4122553
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
Epoch: 18 cost time: 2.2018706798553467
vali loss: 0.6233940720558167
vali loss: 0.39744752645492554
Epoch: 18, Steps: 7 | Train Loss: 0.6180107 Vali Loss: 0.5853800 Test Loss: 0.4123597
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0589113209464907e-05
Epoch: 19 cost time: 2.2716095447540283
vali loss: 0.6249614357948303
vali loss: 0.3976929187774658
Epoch: 19, Steps: 7 | Train Loss: 0.6119901 Vali Loss: 0.5864066 Test Loss: 0.4125020
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.8530201888518416e-05
Epoch: 20 cost time: 2.196579933166504
vali loss: 0.6274303197860718
vali loss: 0.39784786105155945
Epoch: 20, Steps: 7 | Train Loss: 0.6130607 Vali Loss: 0.5883271 Test Loss: 0.4125535
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.6677181699666577e-05
Epoch: 21 cost time: 2.5933191776275635
vali loss: 0.6290392875671387
vali loss: 0.3983486294746399
Epoch: 21, Steps: 7 | Train Loss: 0.6097297 Vali Loss: 0.5893924 Test Loss: 0.4128957
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.5009463529699919e-05
Epoch: 22 cost time: 2.206812620162964
vali loss: 0.6261705160140991
vali loss: 0.3991486430168152
Epoch: 22, Steps: 7 | Train Loss: 0.6107692 Vali Loss: 0.5870669 Test Loss: 0.4135249
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.3508517176729929e-05
Epoch: 23 cost time: 2.233175277709961
vali loss: 0.6280796527862549
vali loss: 0.3990413546562195
Epoch: 23, Steps: 7 | Train Loss: 0.6100488 Vali Loss: 0.5884327 Test Loss: 0.4134486
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.2157665459056936e-05
Epoch: 24 cost time: 2.1904523372650146
vali loss: 0.6281933784484863
vali loss: 0.39907586574554443
Epoch: 24, Steps: 7 | Train Loss: 0.6095141 Vali Loss: 0.5886030 Test Loss: 0.4134218
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.0941898913151242e-05
Epoch: 25 cost time: 2.2121670246124268
vali loss: 0.6269509196281433
vali loss: 0.39943814277648926
Epoch: 25, Steps: 7 | Train Loss: 0.6090262 Vali Loss: 0.5878592 Test Loss: 0.4136285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : loss_flag2_lr0.0001_dm256_336_720_PatchMixer_ETTh2_ftM_sl336_pl720_p16s8_random2021_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.39695531129837036, mae:0.4273523688316345, rse:0.505124032497406
