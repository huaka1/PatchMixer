Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=1024, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=256, data='ETTh1', data_path='ETTh1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1', distil=True, do_predict=False, dropout=0.2, e_layers=1, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.05, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=0, learning_rate=0.0001, loss='mse', loss_flag=2, lradj='type3', mixer_kernel_size=8, model='PatchMixer', model_id='336_192', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=10, pct_start=0.3, pred_len=192, random_seed=2021, revin=1, root_path='./dataset/ETT-small/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : loss_flag2_lr0.0001_dm256_336_192_PatchMixer_ETTh1_ftM_sl336_pl192_p16s8_random2021_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8113
val 2689
test 2689
Epoch: 1 cost time: 3.6176116466522217
Epoch: 1, Steps: 7 | Train Loss: 0.6080582 Vali Loss: 1.1297126 Test Loss: 0.5867162
Validation loss decreased (inf --> 1.129713).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 3.5942635536193848
Epoch: 2, Steps: 7 | Train Loss: 0.6126479 Vali Loss: 1.1002250 Test Loss: 0.6293985
Validation loss decreased (1.129713 --> 1.100225).  Saving model ...
Updating learning rate to 0.0001
Epoch: 3 cost time: 3.560544729232788
Epoch: 3, Steps: 7 | Train Loss: 0.5634817 Vali Loss: 0.9371008 Test Loss: 0.5078768
Validation loss decreased (1.100225 --> 0.937101).  Saving model ...
Updating learning rate to 0.0001
Epoch: 4 cost time: 3.471627950668335
Epoch: 4, Steps: 7 | Train Loss: 0.5250645 Vali Loss: 0.9069021 Test Loss: 0.4554398
Validation loss decreased (0.937101 --> 0.906902).  Saving model ...
Updating learning rate to 9e-05
Epoch: 5 cost time: 3.440972089767456
Epoch: 5, Steps: 7 | Train Loss: 0.4946886 Vali Loss: 0.8731305 Test Loss: 0.4431723
Validation loss decreased (0.906902 --> 0.873131).  Saving model ...
Updating learning rate to 8.1e-05
Epoch: 6 cost time: 3.2855005264282227
Epoch: 6, Steps: 7 | Train Loss: 0.4764472 Vali Loss: 0.8644274 Test Loss: 0.4357935
Validation loss decreased (0.873131 --> 0.864427).  Saving model ...
Updating learning rate to 7.290000000000001e-05
Epoch: 7 cost time: 3.2751123905181885
Epoch: 7, Steps: 7 | Train Loss: 0.4624152 Vali Loss: 0.8448030 Test Loss: 0.4194400
Validation loss decreased (0.864427 --> 0.844803).  Saving model ...
Updating learning rate to 6.561e-05
Epoch: 8 cost time: 3.2110509872436523
Epoch: 8, Steps: 7 | Train Loss: 0.4511972 Vali Loss: 0.8266202 Test Loss: 0.4074683
Validation loss decreased (0.844803 --> 0.826620).  Saving model ...
Updating learning rate to 5.904900000000001e-05
Epoch: 9 cost time: 3.2029433250427246
Epoch: 9, Steps: 7 | Train Loss: 0.4427899 Vali Loss: 0.8101401 Test Loss: 0.3993624
Validation loss decreased (0.826620 --> 0.810140).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
Epoch: 10 cost time: 3.102971315383911
Epoch: 10, Steps: 7 | Train Loss: 0.4387118 Vali Loss: 0.7990151 Test Loss: 0.3951489
Validation loss decreased (0.810140 --> 0.799015).  Saving model ...
Updating learning rate to 4.782969000000001e-05
Epoch: 11 cost time: 3.061211109161377
Epoch: 11, Steps: 7 | Train Loss: 0.4352244 Vali Loss: 0.7986626 Test Loss: 0.3930467
Validation loss decreased (0.799015 --> 0.798663).  Saving model ...
Updating learning rate to 4.304672100000001e-05
Epoch: 12 cost time: 3.0230212211608887
Epoch: 12, Steps: 7 | Train Loss: 0.4312830 Vali Loss: 0.8009069 Test Loss: 0.3903105
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
Epoch: 13 cost time: 2.974822998046875
Epoch: 13, Steps: 7 | Train Loss: 0.4294755 Vali Loss: 0.8023726 Test Loss: 0.3893871
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.486784401000001e-05
Epoch: 14 cost time: 3.0781989097595215
Epoch: 14, Steps: 7 | Train Loss: 0.4285346 Vali Loss: 0.8071839 Test Loss: 0.3879920
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.138105960900001e-05
Epoch: 15 cost time: 3.0838730335235596
Epoch: 15, Steps: 7 | Train Loss: 0.4280403 Vali Loss: 0.8026298 Test Loss: 0.3874799
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.824295364810001e-05
Epoch: 16 cost time: 3.1793453693389893
Epoch: 16, Steps: 7 | Train Loss: 0.4239180 Vali Loss: 0.7865492 Test Loss: 0.3871996
Validation loss decreased (0.798663 --> 0.786549).  Saving model ...
Updating learning rate to 2.541865828329001e-05
Epoch: 17 cost time: 3.1807048320770264
Epoch: 17, Steps: 7 | Train Loss: 0.4246488 Vali Loss: 0.7903233 Test Loss: 0.3864152
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
Epoch: 18 cost time: 3.0920369625091553
Epoch: 18, Steps: 7 | Train Loss: 0.4228735 Vali Loss: 0.7953955 Test Loss: 0.3855254
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
Epoch: 19 cost time: 3.1909916400909424
Epoch: 19, Steps: 7 | Train Loss: 0.4213967 Vali Loss: 0.7966866 Test Loss: 0.3849581
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8530201888518416e-05
Epoch: 20 cost time: 3.134582042694092
Epoch: 20, Steps: 7 | Train Loss: 0.4225101 Vali Loss: 0.7875171 Test Loss: 0.3853639
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6677181699666577e-05
Epoch: 21 cost time: 3.155240297317505
Epoch: 21, Steps: 7 | Train Loss: 0.4214128 Vali Loss: 0.7954610 Test Loss: 0.3855293
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5009463529699919e-05
Epoch: 22 cost time: 3.1965537071228027
Epoch: 22, Steps: 7 | Train Loss: 0.4221260 Vali Loss: 0.7935174 Test Loss: 0.3847665
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.3508517176729929e-05
Epoch: 23 cost time: 2.990886688232422
Epoch: 23, Steps: 7 | Train Loss: 0.4216058 Vali Loss: 0.7896479 Test Loss: 0.3843280
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.2157665459056936e-05
Epoch: 24 cost time: 3.0782012939453125
Epoch: 24, Steps: 7 | Train Loss: 0.4203011 Vali Loss: 0.7869486 Test Loss: 0.3843049
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.0941898913151242e-05
Epoch: 25 cost time: 2.988642930984497
Epoch: 25, Steps: 7 | Train Loss: 0.4202624 Vali Loss: 0.7926913 Test Loss: 0.3842998
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.847709021836118e-06
Epoch: 26 cost time: 2.998502492904663
Epoch: 26, Steps: 7 | Train Loss: 0.4194652 Vali Loss: 0.7907980 Test Loss: 0.3842909
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : loss_flag2_lr0.0001_dm256_336_192_PatchMixer_ETTh1_ftM_sl336_pl192_p16s8_random2021_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
mse:0.3770934045314789, mae:0.3973059356212616, rse:0.5958968997001648
